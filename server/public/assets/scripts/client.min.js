var app=angular.module("myApp",["ngRoute"]),globalId={id:1,name:"No User Selected"},globalOrders=[],globalAddresses=[];app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/view1",{templateUrl:"views/view1.html",controller:"View1Controller"}).when("/view2",{templateUrl:"views/view2.html",controller:"View2Controller"})}]),app.controller("IndexController",["$scope","$http",function(a,b){a.title="Weekend Assignment, Week 5: Fun with Postgres",a.users=[],userList=function(){b.get("/api/user").then(function(b){console.log("repsonse in user call.",b.data),a.users=b.data})},userList(),addressList=function(){b.post("/api/addresses",globalId).then(function(a){console.log("repsonse in addresses call.",a.data),globalAddresses=a.data})},orderList=function(){b.post("/api/orders",globalId).then(function(a){console.log("repsonse in order call.",a.data),globalOrders=a.data})},a.grabId=function(a){console.log("user id in function",a),globalId.id=a.id,globalId.name=a.name,addressList(),orderList()}}]),app.controller("View1Controller",["$scope","$http",function(a,b){a.title="Addresses on file for selected user.",a.name=globalId.name,a.addresses=[],localScope=function(){a.addresses=globalAddresses},localScope(),console.log("addresses in view one",a.addresses)}]),app.controller("View2Controller",["$scope","$http",function(a,b){a.title="Search Orders by Date",a.name=globalId.name,a.range={},a.orders=[],localScope=function(){for(var b=[],c=0;c<globalOrders.length;c++)globalOrders[c].user_id==globalId.id&&b.push(globalOrders[c]);a.orders=b},localScope(),console.log("orders in scope",a.orders),a.checkDate=function(){console.log("start date check",a.range.startDate),console.log("end date check",a.range.endDate);for(var b=0;b<a.orders.length;b++)a.orders[b].order_date>=a.range.startDate&&a.orders[b].order_date<=a.range.endDate&&console.log(a.orders[b])}}]);